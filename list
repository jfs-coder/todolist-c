port this code to GOLANG
refactor this code
comment this code way better
keep the code clean
